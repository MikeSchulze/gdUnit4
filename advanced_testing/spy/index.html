<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="stylesheet" href="/gdUnit4/assets/css/just-the-docs-default.css"> <script src="/gdUnit4/assets/js/vendor/lunr.min.js"></script> <script src="/gdUnit4/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Spying | GdUnit4</title> <meta name="generator" content="Jekyll v3.9.3" /> <meta property="og:title" content="Spying" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Spy" /> <meta property="og:description" content="Spy" /> <meta property="og:site_name" content="GdUnit4" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Spying" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"Spy","headline":"Spying","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"/gdUnit4/assets/images/logo.png"}},"url":"/gdUnit4/advanced_testing/spy/"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path> <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle> <line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line> <line x1="3" y1="6" x2="21" y2="6"></line> <line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path> <polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="/gdUnit4/" class="site-title lh-tight"><div class="site-logo"></div> GdUnit4</a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"> <use xlink:href="#svg-menu"></use> </svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <div class="nav-category">First Steps</div> <ul class="nav-list"><li class="nav-list-item"><a href="/gdUnit4/first_steps/install/" class="nav-list-link">Installation</a></li><li class="nav-list-item"><a href="/gdUnit4/first_steps/settings/" class="nav-list-link">Settings</a></li><li class="nav-list-item"><a href="/gdUnit4/first_steps/firstTest/" class="nav-list-link">Create Your First Test</a></li></ul> <div class="nav-category"></div> <ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander" aria-label="toggle links in Asserts category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/gdUnit4/asserts/index/" class="nav-list-link">Asserts</a><ul class="nav-list"><li class="nav-list-item "><a href="/gdUnit4/asserts/assert-string/" class="nav-list-link">String Assert</a></li><li class="nav-list-item "><a href="/gdUnit4/asserts/assert-bool/" class="nav-list-link">Boolean Assert</a></li><li class="nav-list-item "><a href="/gdUnit4/asserts/assert-integer/" class="nav-list-link">Integer Assert</a></li><li class="nav-list-item "><a href="/gdUnit4/asserts/assert-number/" class="nav-list-link">Number Assert</a></li><li class="nav-list-item "><a href="/gdUnit4/asserts/assert-float/" class="nav-list-link">Float/Double Assert</a></li><li class="nav-list-item "><a href="/gdUnit4/asserts/assert-array/" class="nav-list-link">Array Assert</a></li><li class="nav-list-item "><a href="/gdUnit4/asserts/assert-dictionary/" class="nav-list-link">Dictionary Assert</a></li><li class="nav-list-item "><a href="/gdUnit4/asserts/assert-object/" class="nav-list-link">Object Assert</a></li><li class="nav-list-item "><a href="/gdUnit4/asserts/assert-vector/" class="nav-list-link">Vector Assert</a></li><li class="nav-list-item "><a href="/gdUnit4/asserts/assert-file/" class="nav-list-link">File Assert</a></li><li class="nav-list-item "><a href="/gdUnit4/asserts/assert-function/" class="nav-list-link">Function/Method Assert</a></li><li class="nav-list-item "><a href="/gdUnit4/asserts/assert-signal/" class="nav-list-link">Signal Assert</a></li><li class="nav-list-item "><a href="/gdUnit4/asserts/assert-error/" class="nav-list-link">Error Assert</a></li><li class="nav-list-item "><a href="/gdUnit4/asserts/assert-that/" class="nav-list-link">AssertThat</a></li></ul></li></ul> <div class="nav-category"></div> <ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander" aria-label="toggle links in Advanced Testing category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/gdUnit4/advanced_testing/index/" class="nav-list-link">Advanced Testing</a><ul class="nav-list"><li class="nav-list-item "><a href="/gdUnit4/advanced_testing/tools/" class="nav-list-link">Tools and Helpers</a></li><li class="nav-list-item "><a href="/gdUnit4/advanced_testing/fuzzing/" class="nav-list-link">Fuzzing</a></li><li class="nav-list-item "><a href="/gdUnit4/advanced_testing/paramerized_tests/" class="nav-list-link">Parameterized Tests</a></li><li class="nav-list-item "><a href="/gdUnit4/advanced_testing/mock/" class="nav-list-link">Mocking</a></li><li class="nav-list-item "><a href="/gdUnit4/advanced_testing/signals/" class="nav-list-link">Signals</a></li><li class="nav-list-item active"><a href="/gdUnit4/advanced_testing/spy/" class="nav-list-link active">Spying</a></li><li class="nav-list-item "><a href="/gdUnit4/advanced_testing/argument_matchers/" class="nav-list-link">Argument Matchers</a></li><li class="nav-list-item "><a href="/gdUnit4/advanced_testing/sceneRunner/" class="nav-list-link">Scene Runner</a></li><li class="nav-list-item "><a href="/gdUnit4/advanced_testing/orphan/" class="nav-list-link">Orphan Nodes</a></li><li class="nav-list-item "><a href="/gdUnit4/advanced_testing/cmd/" class="nav-list-link">Command Line Tool</a></li></ul></li></ul> <div class="nav-category"></div> <ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander" aria-label="toggle links in Tutorials category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/gdUnit4/tutorials/index/" class="nav-list-link">Tutorials</a><ul class="nav-list"><li class="nav-list-item "><a href="/gdUnit4/tutorials/tdd/" class="nav-list-link">Test Driven Development</a></li><li class="nav-list-item "><a href="/gdUnit4/tutorials/scenerunner_examples/" class="nav-list-link">Testing Scene Interactions</a></li><li class="nav-list-item "><a href="/gdUnit4/tutorials/tutorial_basics/" class="nav-list-link">Basics</a></li></ul></li></ul> <div class="nav-category">FAQ</div> <ul class="nav-list"><li class="nav-list-item"><a href="/gdUnit4/faq/inspector/" class="nav-list-link">Inspector</a></li><li class="nav-list-item"><a href="/gdUnit4/faq/run-tests/" class="nav-list-link">How To Run Tests</a></li><li class="nav-list-item"><a href="/gdUnit4/faq/skip-tests/" class="nav-list-link">How To Skip Tests</a></li><li class="nav-list-item"><a href="/gdUnit4/faq/test-case/" class="nav-list-link">TestCase</a></li><li class="nav-list-item"><a href="/gdUnit4/faq/test-suite/" class="nav-list-link">TestSuite</a></li><li class="nav-list-item"><a href="/gdUnit4/faq/C%23/" class="nav-list-link">C# Support</a></li><li class="nav-list-item"><a href="/gdUnit4/faq/ci/" class="nav-list-link">Continuous Integration Testing</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search GdUnit4" aria-label="Search GdUnit4" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"> <use xlink:href="#svg-search"></use> </svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="//github.com/MikeSchulze/gdUnit4" class="site-button" target="_blank" rel="noopener noreferrer" > GdUnit4 on GitHub </a> </li> </ul> </nav> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="">Advanced Testing</a></li> <li class="breadcrumb-nav-list-item"><span>Spying</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <h1 id="spy"> <a href="#spy" class="anchor-heading" aria-labelledby="spy"><svg viewBox="0 0 16 16" aria-hidden="true"> <use xlink:href="#svg-link"></use> </svg></a> Spy </h1> <h2 id="note-spy-is-current-only-supported-for-gdscripts"> <a href="#note-spy-is-current-only-supported-for-gdscripts" class="anchor-heading" aria-labelledby="note-spy-is-current-only-supported-for-gdscripts"><svg viewBox="0 0 16 16" aria-hidden="true"> <use xlink:href="#svg-link"></use> </svg></a> <strong><em>Note: Spy is current only supported for GdScripts.</em></strong> </h2> <h2 id="definition"> <a href="#definition" class="anchor-heading" aria-labelledby="definition"><svg viewBox="0 0 16 16" aria-hidden="true"> <use xlink:href="#svg-link"></use> </svg></a> Definition </h2> <p>A Spy is used to verify a certain behavior during a test and tracks all function calls and their parameters of an instance.</p> <p><code class="language-plaintext highlighter-rouge">var to_spy := spy(&lt;instance&gt;)</code></p> <h2 id="what-is-the-difference-between-a-spy-and-an-mock"> <a href="#what-is-the-difference-between-a-spy-and-an-mock" class="anchor-heading" aria-labelledby="what-is-the-difference-between-a-spy-and-an-mock"><svg viewBox="0 0 16 16" aria-hidden="true"> <use xlink:href="#svg-link"></use> </svg></a> <em>What is the difference between a spy and an mock?</em> </h2> <p>In contrast to a mock, a spy calls the real implementation. It behaves in the same way as the normal instance.</p><hr /> <h2 id="how-to-use-a-spy"> <a href="#how-to-use-a-spy" class="anchor-heading" aria-labelledby="how-to-use-a-spy"><svg viewBox="0 0 16 16" aria-hidden="true"> <use xlink:href="#svg-link"></use> </svg></a> How to use a Spy </h2> <p>To spy on an object, simply use <strong>spy(&lt;instance&gt;)</strong>. A spied instance is marked for auto-freeing, so you don’t need to free it manually.</p> <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="n">var</span> <span class="n">spy</span><span class="p">:</span><span class="o">=</span> <span class="n">spy</span><span class="p">(</span><span class="n">auto_free</span><span class="p">(</span><span class="no">Node</span><span class="p">.</span><span class="nf">new</span><span class="p">()))</span>
</code></pre></div></div> <p>Here a small example to use the spy on a instance of the class ‘TestClass’:</p> <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="n">class_name</span> <span class="no">TestClass</span>
    <span class="n">extends</span> <span class="no">Node</span>

        <span class="n">func</span> <span class="n">message</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="no">String</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">"a message"</span>

    <span class="n">func</span> <span class="n">test_spy</span><span class="p">():</span>
        <span class="n">var</span> <span class="n">instance</span> <span class="o">=</span> <span class="n">auto_free</span><span class="p">(</span><span class="no">TestClass</span><span class="p">.</span><span class="nf">new</span><span class="p">())</span>

        <span class="c1"># Build a spy on the instance</span>
        <span class="n">var</span> <span class="n">spy</span> <span class="o">=</span> <span class="n">spy</span><span class="p">(</span><span class="n">instance</span><span class="p">)</span>

        <span class="c1"># Call function `message` on the spy to track the interaction</span>
        <span class="n">spy</span><span class="p">.</span><span class="nf">message</span><span class="p">()</span>

        <span class="c1"># Verify the function 'message' is called one times</span>
        <span class="n">verify</span><span class="p">(</span><span class="n">spy</span><span class="p">,</span> <span class="mi">1</span><span class="p">).</span><span class="nf">message</span><span class="p">()</span>
</code></pre></div></div> <h2 id="verification-of-function-calls"> <a href="#verification-of-function-calls" class="anchor-heading" aria-labelledby="verification-of-function-calls"><svg viewBox="0 0 16 16" aria-hidden="true"> <use xlink:href="#svg-link"></use> </svg></a> Verification of Function Calls </h2> <p>A spy keeps track of all function calls and their arguments. Use the <strong>verify()</strong> method on the spy to verify that certain behavior happened at least once or an exact number of times. This way, you can check if a particular function was called and how many times it was called.</p> <div class="table-wrapper"><table> <thead> <tr> <th>Function</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><a href="/gdUnit4/advanced_testing/spy/#verify">verify</a></td> <td>Verifies that certain behavior happened at least once or an exact number of times.</td> </tr> <tr> <td><a href="/gdUnit4/advanced_testing/spy/#verify_no_interactions">verify_no_interactions</a></td> <td>Verifies that no interactions happened on the spy.</td> </tr> <tr> <td><a href="/gdUnit4/advanced_testing/spy/#verify_no_more_interactions">verify_no_more_interactions</a></td> <td>Verifies that the given spy has no unverified interactions.</td> </tr> <tr> <td><a href="/gdUnit4/advanced_testing/spy/#reset">reset</a></td> <td>Resets the saved function call counters on a spy.</td> </tr> </tbody> </table></div> <ul> <li> <p><strong>verify</strong><br /> The <strong>verify()</strong> method is used to verify that a function was called a certain number of times. It takes two arguments: the spy instance and the expected number of times the function should have been called. You can also use argument matchers to verify that specific arguments were passed to the function.</p> <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      <span class="n">verify</span><span class="p">(</span><span class="o">&lt;</span><span class="n">spy</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">times</span><span class="o">&gt;</span><span class="p">).</span><span class="nf">function</span><span class="p">(</span><span class="o">&lt;</span><span class="n">args</span><span class="o">&gt;</span><span class="p">)</span>
</code></pre></div> </div> <p>Here’s an example:</p> <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      <span class="n">var</span> <span class="n">spyed_node</span> <span class="ss">:Node</span> <span class="o">=</span> <span class="n">spy</span><span class="p">(</span><span class="no">Node</span><span class="p">.</span><span class="nf">new</span><span class="p">())</span>
        
      <span class="c1"># Verify we have no interactions currently on this instance</span>
      <span class="n">verify_no_interactions</span><span class="p">(</span><span class="n">spyed_node</span><span class="p">)</span>
        
      <span class="c1"># Call with different arguments</span>
      <span class="n">spyed_node</span><span class="p">.</span><span class="nf">set_process</span><span class="p">(</span><span class="kp">false</span><span class="p">)</span> <span class="c1"># 1 times</span>
      <span class="n">spyed_node</span><span class="p">.</span><span class="nf">set_process</span><span class="p">(</span><span class="kp">true</span><span class="p">)</span> <span class="c1"># 1 times</span>
      <span class="n">spyed_node</span><span class="p">.</span><span class="nf">set_process</span><span class="p">(</span><span class="kp">true</span><span class="p">)</span> <span class="c1"># 2 times</span>
        
      <span class="c1"># Verify how often we called the function with different argument </span>
      <span class="n">verify</span><span class="p">(</span><span class="n">spyed_node</span><span class="p">,</span> <span class="mi">1</span><span class="p">).</span><span class="nf">set_process</span><span class="p">(</span><span class="kp">false</span><span class="p">)</span><span class="c1"># in sum one time with false</span>
      <span class="n">verify</span><span class="p">(</span><span class="n">spyed_node</span><span class="p">,</span> <span class="mi">2</span><span class="p">).</span><span class="nf">set_process</span><span class="p">(</span><span class="kp">true</span><span class="p">)</span> <span class="c1"># in sum two times with true</span>

      <span class="c1"># Verify will fail because we expect the function `set_process(true)` to be called 3 times but it was only called 2 times</span>
      <span class="n">verify</span><span class="p">(</span><span class="n">spyed_node</span><span class="p">,</span> <span class="mi">3</span><span class="p">).</span><span class="nf">set_process</span><span class="p">(</span><span class="kp">true</span><span class="p">)</span>
</code></pre></div> </div> </li> <li> <p><strong>verify_no_interactions</strong><br /> The <strong>verify_no_interactions()</strong> method verifies that no function calls were made on the spy.</p> <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      <span class="n">verify_no_interactions</span><span class="p">(</span><span class="o">&lt;</span><span class="n">spy</span><span class="o">&gt;</span><span class="p">)</span>
</code></pre></div> </div> <p>Here’s an example:</p> <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      <span class="n">var</span> <span class="n">spyed_node</span> <span class="p">:</span><span class="o">=</span> <span class="n">spy</span><span class="p">(</span><span class="no">Node</span><span class="p">.</span><span class="nf">new</span><span class="p">())</span> <span class="n">as</span> <span class="no">Node</span>
        
      <span class="c1"># Test that we have no initial interactions on this spy</span>
      <span class="n">verify_no_interactions</span><span class="p">(</span><span class="n">spyed_node</span><span class="p">)</span>

      <span class="c1"># Interact by calling `get_name()`</span>
      <span class="n">spyed_node</span><span class="p">.</span><span class="nf">get_name</span><span class="p">()</span>

      <span class="c1"># Now this verification will fail because we have interacted on this spy by calling `get_name`</span>
      <span class="n">verify_no_interactions</span><span class="p">(</span><span class="n">spyed_node</span><span class="p">)</span>
</code></pre></div> </div> </li> <li> <p><strong>verify_no_more_interactions</strong><br /> The <strong>verify_no_more_interactions()</strong> method verifies that all interactions on the spy have been verified. If the spy has recorded more interactions than you verified with <strong>verify()</strong>, an error is reported.</p> <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      <span class="n">verify_no_more_interactions</span><span class="p">(</span><span class="o">&lt;</span><span class="n">spy</span><span class="o">&gt;</span><span class="p">)</span>
</code></pre></div> </div> <p>Here’s an example:</p> <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      <span class="n">var</span> <span class="n">spyed_node</span> <span class="p">:</span><span class="o">=</span> <span class="n">spy</span><span class="p">(</span><span class="no">Node</span><span class="p">.</span><span class="nf">new</span><span class="p">())</span> <span class="n">as</span> <span class="no">Node</span>
        
      <span class="c1"># Interact on two functions </span>
      <span class="n">spyed_node</span><span class="p">.</span><span class="nf">is_a_parent_of</span><span class="p">(</span><span class="n">null</span><span class="p">)</span>
      <span class="n">spyed_node</span><span class="p">.</span><span class="nf">set_process</span><span class="p">(</span><span class="kp">false</span><span class="p">)</span>

      <span class="c1"># Verify that the spy interacts as expected</span>
      <span class="n">verify</span><span class="p">(</span><span class="n">spyed_node</span><span class="p">).</span><span class="nf">is_a_parent_of</span><span class="p">(</span><span class="n">null</span><span class="p">)</span>
      <span class="n">verify</span><span class="p">(</span><span class="n">spyed_node</span><span class="p">).</span><span class="nf">set_process</span><span class="p">(</span><span class="kp">false</span><span class="p">)</span>

      <span class="c1"># Check that there are no further interactions with the spy</span>
      <span class="n">verify_no_more_interactions</span><span class="p">(</span><span class="n">spyed_node</span><span class="p">)</span>

      <span class="c1"># Simulate an unexpected interaction with `set_process`</span>
      <span class="n">spyed_node</span><span class="p">.</span><span class="nf">set_process</span><span class="p">(</span><span class="kp">false</span><span class="p">)</span>

      <span class="c1"># Verify that there are no further interactions with the spy</span>
      <span class="c1"># and that the previous unexpected interaction is detected (the test will fail here)</span>
      <span class="n">verify_no_more_interactions</span><span class="p">(</span><span class="n">spyed_node</span><span class="p">)</span>
</code></pre></div> </div> </li> <li> <p><strong>reset</strong><br /> Resets the recorded function interactions of the given spy.<br /> Sometimes we want to reuse an already created spy for different test scenarios and have to reset the recorded interactions.</p> <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      <span class="n">reset</span><span class="p">(</span><span class="o">&lt;</span><span class="n">spy</span><span class="o">&gt;</span><span class="p">)</span>
</code></pre></div> </div> <p>Here’s an example:</p> <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      <span class="n">var</span> <span class="n">spyed_node</span> <span class="ss">:Node</span> <span class="o">=</span> <span class="n">spy</span><span class="p">(</span><span class="no">Node</span><span class="p">.</span><span class="nf">new</span><span class="p">())</span>
        
      <span class="c1"># First, we test by interacting with two functions </span>
      <span class="n">spyed_node</span><span class="p">.</span><span class="nf">is_a_parent_of</span><span class="p">(</span><span class="n">null</span><span class="p">)</span>
      <span class="n">spyed_node</span><span class="p">.</span><span class="nf">set_process</span><span class="p">(</span><span class="kp">false</span><span class="p">)</span>

      <span class="c1"># Verify if the interactions were recorded; at this point, two interactions are recorded</span>
      <span class="n">verify</span><span class="p">(</span><span class="n">spyed_node</span><span class="p">).</span><span class="nf">is_a_parent_of</span><span class="p">(</span><span class="n">null</span><span class="p">)</span>
      <span class="n">verify</span><span class="p">(</span><span class="n">spyed_node</span><span class="p">).</span><span class="nf">set_process</span><span class="p">(</span><span class="kp">false</span><span class="p">)</span>

      <span class="c1"># Now, we want to test a different scenario and we need to reset the current recorded interactions</span>
      <span class="n">reset</span><span class="p">(</span><span class="n">spyed_node</span><span class="p">)</span>
      <span class="c1"># Verify that the previously recorded interactions have been removed</span>
      <span class="n">verify_no_more_interactions</span><span class="p">(</span><span class="n">spyed_node</span><span class="p">)</span>

      <span class="c1"># Continue testing</span>
      <span class="n">spyed_node</span><span class="p">.</span><span class="nf">set_process</span><span class="p">(</span><span class="kp">true</span><span class="p">)</span>
      <span class="n">verify</span><span class="p">(</span><span class="n">spyed_node</span><span class="p">).</span><span class="nf">set_process</span><span class="p">(</span><span class="kp">true</span><span class="p">)</span>
      <span class="n">verify_no_more_interactions</span><span class="p">(</span><span class="n">spyed_node</span><span class="p">)</span>
</code></pre></div> </div> </li> </ul><hr /> <h2 id="argument-matchers-and-spys"> <a href="#argument-matchers-and-spys" class="anchor-heading" aria-labelledby="argument-matchers-and-spys"><svg viewBox="0 0 16 16" aria-hidden="true"> <use xlink:href="#svg-link"></use> </svg></a> Argument Matchers and spys </h2> <p>Argument matchers allow you to simplify the verification of function calls by verifying function arguments based on their type or class. This is particularly useful when working with spys because you can use argument matchers to verify function calls without specifying the exact argument values.</p> <p>For example, instead of verifying that a function was called with a specific boolean argument value, you can use the <strong>any_bool()</strong> argument matcher to verify that the function was called with any boolean value. Here’s an example:</p> <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="n">var</span> <span class="n">spyed_node</span> <span class="ss">:Node</span> <span class="o">=</span> <span class="n">spy</span><span class="p">(</span><span class="no">Node</span><span class="p">.</span><span class="nf">new</span><span class="p">())</span>
    
    <span class="c1"># Call the function with different arguments</span>
    <span class="n">spyed_node</span><span class="p">.</span><span class="nf">set_process</span><span class="p">(</span><span class="kp">false</span><span class="p">)</span> <span class="c1"># Called 1 time</span>
    <span class="n">spyed_node</span><span class="p">.</span><span class="nf">set_process</span><span class="p">(</span><span class="kp">true</span><span class="p">)</span> <span class="c1"># Called 1 time</span>
    <span class="n">spyed_node</span><span class="p">.</span><span class="nf">set_process</span><span class="p">(</span><span class="kp">true</span><span class="p">)</span> <span class="c1"># Called 2 times</span>
    
    <span class="c1"># Verify that the function was called with any boolean value 3 times</span>
    <span class="n">verify</span><span class="p">(</span><span class="n">spyed_node</span><span class="p">,</span> <span class="mi">3</span><span class="p">).</span><span class="nf">set_process</span><span class="p">(</span><span class="n">any_bool</span><span class="p">())</span>
</code></pre></div></div> <p>For more details on how to use argument matchers, please see the <a href="/gdUnit4/advanced_testing/argument_matchers">Argument Matchers</a> section.</p><hr /> <h4> <a href="#argument-matchers-and-spys" class="anchor-heading" aria-labelledby="argument-matchers-and-spys"><svg viewBox="0 0 16 16" aria-hidden="true"> <use xlink:href="#svg-link"></use> </svg></a> document version v4.1.0 </h4> <hr> <footer> <p class="text-small text-grey-dk-100 mb-0">Copyright &copy; 2021-2023 Mike Schulze. Distributed by an <a href="https://github.com/MikeSchulze/gdUnit4/blob/master/LICENSE">MIT license.</a></p> </footer> </div> </div> <div class="search-overlay"></div> </div> <script src="/gdUnit4/assets/js/tabs.js"></script> <link rel="stylesheet" href="/gdUnit4/assets/css/tab.css" /> <link rel="stylesheet" href="/gdUnit4/assets/css/site-header.css" /> </body> </html>
