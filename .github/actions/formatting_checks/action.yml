name: 'Formatting Checks'
description: 'Validate YAML, XML, Markdown, and GitHub Actions workflow files'
author: 'MikeSchulze'

inputs:
  use-gitignore:
    description: 'Use .gitignore for validation exclusions'
    required: false
    default: 'true'

  actionlint-fail-on-error:
    description: 'Fail the action on actionlint errors'
    required: false
    default: 'true'

runs:
  using: 'composite'
  steps:
    - name: 'Validate YAML files'
      uses: ibiqlik/action-yamllint@v3
      with:
        config_file: ".github/actions/formatting_checks/.yamllint.yml"

    - name: 'Validate GitHub Actions workflows'
      uses: raven-actions/actionlint@v2
      with:
        fail-on-error: ${{ inputs.actionlint-fail-on-error }}
        matcher: true

    - name: 'Validate JSON and YAML syntax'
      uses: GrantBirki/json-yaml-validate@v3.3.2
      with:
        exclude_file: ".github/actions/formatting_checks/.validationignore"
        use_gitignore: ${{ inputs.use-gitignore }}

    - name: 'Validate Markdown files'
      uses: DavidAnson/markdownlint-cli2-action@v20
      with:
        config: ".github/actions/formatting_checks/.markdownlint.jsonc"

    - name: "Setup .Net"
      uses: actions/setup-dotnet@v5
      with:
        global-json-file: 'global.json'

    - name: "C# Code Formatting"
      shell: bash
      run: |
        dotnet format gdUnit4.csproj --verify-no-changes --verbosity diagnostic
